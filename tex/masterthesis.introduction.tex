\chapter{Introduction}

Due to the advancements in hardware technology and solution algorithms, the involvement of numerical methods in sciences and industrial practice has increased significantly during the past decades, having an enormous impact on academic research and processes in industrial development. Besides theoretical or experimental approaches, numerical methods nowadays form an integral part in fostering a better understanding of physical phenomena and in modeling the behavior of technical systems. Numerical methods are used for the simulation of fluid flow problems, a branch of numerics also known as \emph{CFD} (\emph{Computational Fluid Dynamics}). CFD continuously reaches the limits of current simulation environments, creating new challenges to further improvements of the deployed hardware and software. CFD methods not only have to respond to a higher level of complexity, which may include complex geometries or multiphysics, but they also are expected to generate results after shorter periods of simulation. In order to overcome these challenges, research is done into the implementation of novel and more efficient algorithms; apart from that, CFD applications often rely on the efficient usage of high-performance computer clusters. 

In the field of CFD, the incompressible Navier-Stokes equations represent the commonly used mathematical model for low Mach number fluid flows. Among other properties, this model couples two variables, velocity and pressure. Thus, algorithms that tend to solve for incompressible flow fields have to address the so-called pressure-velocity coupling. A standard approach is to resolve this coupling through segregated solution methods. By these methods, the algebraic equations for each of the dependent variables are solved sequentially, using approximate values for the other involved variables. One common representative of this class of algorithms is the \emph{SIMPLE}-algorithm (\emph{Semi-Implicit Method for Pressure-Linked Equations}), being widely used in scientific codes or industrial solvers due to its small memory requirements and the efficient iterative solvers which exist for the resulting linear systems. Reference \cite{acharya07} reviews the evolution of segregated solution algorithms.

The use of segregated solution algorithms entails significant deficiencies. In order to stabilize the iteration for the coupling process, the obtained solutions have to be under-relaxed. In doing so, the degree of under-relaxation also depends on the problem to be solved. Not only does this degrade the solver's performance, but, making things even more difficult, there also do not exist strict rules for the best selection of the amount of under-relaxation. Furthermore, algorithms like SIMPLE lack scalability with the mesh size. Resolving the pressure-velocity coupling defines the flow solver's performance. Consequently, new coupling algorithms, more robust or even independent of parameters, and, at the same time, resource efficient in their application, have to be developed. \cite{peric90} offers a helpful analysis of the pressure-velocity coupling.

\section{State of Research and Knowledge}

Considering the solution approach, pressure-based solution algorithms for incompressible Navier-Stokes equations can be divided into segregated solution methods and semi-direct or coupled solution methods. Segregated solution methods, as for example the well-known SIMPLE-algorithm \cite{patankar72}, have been actively used during the past decades. One common property of segregated solution algorithms is the two-step solution approach, involving a predictor step and a corrector step. In the first step, a velocity field is calculated based on an estimate of the pressure field, in the second step a pressure equation or a pressure-correction equation is solved. After this, the velocities are corrected. Many variants of segregated solution methods have been developed over the time, aiming to increase the robustness and efficiency of the SIMPLE-algorithm. The other chiefly used ones, besides the SIMPLE-algorithm, are \emph{SIMPLER} (\emph{SIMPLE Revised}) \cite{patankar80}, \emph{SIMPLEC} (\emph{SIMPLE Consistent}) \cite{doormaal84}, and \emph{PISO} (\emph{Pressure Implicit with Splitting of Operator}) \cite{issa86}, which modify the SIMPLE-algorithm. The main advantages of segregated solution algorithms are low memory requirements and the straightforward extension to the solution of additional partial differential equations.\cite{darwish00} gives an overview of segregated solution algorithms.

The SIMPLER-algorithm addresses the inherent problem of the need to under-relax the variables throughout the solution process. Based on the observation that the pressure-correction based velocity-corrections are satisfactory with respect to the improvement of the solution, the pressure-corrections have to be under-relaxed before they are applied to the pressure itself, as pressure-corrections generally tend to be too high. In order to remove the need to under-relax the pressure-correction, the pressure-correction from the SIMPLE algorithm is only used for velocity corrections, whereas a separate pressure equation based on the corrected velocities is derived. The SIMPLEC-algorithm proposes another remedy to the under-relaxation problematic by using a consistent simplification in the derivation of the pressure-correction equation. 

The SIMPLER-algorithm is found to reduce the number of iterations for convergence successfully while increasing the computational effort and having higher memory requirements. The SIMPLEC-algorithm also leads to a smaller, compared to the SIMPLER-algorithm, decrease in the number of iterations for convergence, while there is no notable increase in the computational effort. 

The PISO-algorithm, as does the SIMPLE-algorithm, uses a pressure-correction step to correct the velocities. The pressure-correction step is then, different to the SIMPLE-algorithm, followed by further correction steps to compensate for the simplifications made in the derivation of the pressure-correction equation. Similar to the other modifications, the PISO-algorithm leads to a reduced iteration count for convergence and lacks the necessity to under-relax the pressure-correction. One known drawback of the PISO-algorithm is the higher computational effort and the higher memory requirements.

An alternative solution approach to the problem of numerically solving the Navier-Stokes equations is by means of coupled solvers which simultaneously solve the momentum and mass balance equations. Algorithms of this type, using finite-volume methods, have been presented in \cite{chen10,darwish09,falk13,galpin86,klaij13,mangani14,vakilipour12}. \cite{darwish09} shows that the principal advantages of coupled solution approaches compensate for the deficiencies of segregated solution algorithms. All mentioned references report that, on the one hand, the use of coupled solution methods reduces the computational time, while, on the other hand, the solution algorithm's robustness increases. According to \cite{darwish09} no under-relaxation is necessary at all to obtain a robust implementation. \cite{galpin86} reported insensitivity towards the relaxation allowing faster convergence compared to frequently used segregated solution algorithms. In all mentioned references the two-step, predictor-corrector solution procedure was reduced to one step. An equation for the pressure was deduced using a momentum interpolation scheme \cite{rhie82} in all cited references but \cite{galpin86}.

\cite{chen10} extended the linear system for velocities and pressure by an additional decoupled block accounting for temperature. So far, only \cite{galpin86,vakilipour12} have used coupled solution processes for flow problems implicitly involving temperature transport. The mentioned references extended the scope of a coupled solution process for the two-dimensional Navier-Stokes equations to include a temperature equation. They investigated the effect of different methods on implicit temperature-to-velocity/pressure coupling via a Newton-Raphson linearization on the solver's performance, showing that the use of coupled methods significantly reduces the number of iterations until convergence. The objectives of the present thesis are to implement a fully-coupled solution algorithm for the three-dimensional Navier-Stokes equations and the temperature equation on co-located grids and to analyze their single and multi-processor performance. The methods to achieve temperature coupling are similar to the ones presented in \cite{vakilipour12}. In this reference, the treatment of the interpolation of the volumes in the pressure weighted interpolation method is different from the implementation used in the present thesis. The implementation in \cite{vakilipour12} relies on a geometric partition of the existing volumes other than using a linear interpolation. Another difference results from the used interpolation technique for pressure gradients at faces, for which \cite{vakilipour12} uses local coordinate systems and a wider computational stencil.

\section{Structure of the Thesis}

In chapter \ref{sec:fundamentals}, the thesis introduces the mathematical and physical fundamentals of flow problems presenting the main frame of partial differential equations that have to be solved numerically. Each section outlines a derivation from the continuum mechanical point of view, and shows common simplifications, comprising not only the Navier-Stokes equations for incompressible fluids but also the Boussinesq approximation, which is widely used for incompressible flows when experiencing buoyancy forces.

Chapter \ref{sec:fvm} outlines the fundamentals of finite-volume methods in general. At first, the necessary terminology for numerical grids is introduced. After that, the main approximation principles for the discretization of integral or differential operators are presented, placing particular emphasis on the modifications necessary for discretizing them on non-orthogonal grids. In the end, this chapter outlines the principal method of linearization for the Navier-Stokes equations used throughout the work.

Chapter \ref{sec:seg} focuses on segregated solution methods because many ideas of the commonly used SIMPLE-algorithm are also relevant for the implementation of coupled solution methods. The chapter starts by discretizing the mass balance coming directly from the continuum mechanical introduction of chapter \ref{sec:fundamentals}, outlining its drawbacks on their applicability to co-located variable arrangements. Section \ref{sec:massflux} introduces a remedy to the \emph{checker-boarding} effect surging from an unmodified discretization of the mass balance by proposing a modification of the commonly used Rhie-Chow momentum interpolation scheme \cite{rhie82}. This modification yields results which do not depend on under-relaxation. This fact is important for later comparison studies with the coupled solution algorithm. In section \ref{sec:simple}, the familiar SIMPLE-algorithm is derived, using the previously demonstrated interpolation scheme as a basis for the construction of a pressure-correction equation. In sections \ref{sec:segpresscorr}, \ref{sec:segdiscretization}, and \ref{sec:discretetemperature}, the pressure equation and the two remaining sets of equations, i.e. the three momentum balances and the temperature equation, are discretized. Each section concludes with a complete list of the resulting discretized equations and calculations of the coefficients as implemented in the developed solver framework. Section \ref{sec:segboundary} is dedicated to the implementation of boundary conditions, presenting the necessary modifications to the discretized equations for each boundary condition, inclusive of the treatment of block boundaries. Since in most cases the boundary conditions lead to a singular system for the pressure-correction, section \ref{sec:singularitytreatment} describes methods to constrain the pressure in incompressible flows. This chapter concludes by presenting the non-zero structure of the resulting assembled linear system, taking into account the special treatment of block boundaries with hanging nodes.

Chapter \ref{sec:cpld} describes the implemented coupled solution algorithm. The structure of this chapter resembles the structure of chapter \ref{sec:seg} since both solution approaches share an enormous part of their components. For this reason, this thesis puts particular emphasis on the differences between both algorithms. Section \ref{sec:reconsider} reconsiders the pressure-velocity coupling that accounts for the implicit consideration of the pressure in the momentum balances. A major difference from segregated solution methods is then presented in section \ref{sec:temperaturecoupling}: the coupling to the temperature equation. Here, different methods, varying in their relation of implicit to explicit coupling of velocities, pressure, and temperature, are deduced. After that, the necessary modifications for boundary conditions are presented. Section \ref{sec:cpldassembly} shows the final form of the discretized equations and the resulting structure of the assembled linear systems, placing special emphasis on the effects of the different methods leading to implicit coupling of the momentum balances to the temperature equation and vice versa.

Chapter \ref{sec:caffa} introduces the developed \emph{CAFFA} (\emph{Computer Aided Fluid Flow Analysis}) framework, having its theoretical basis in the preceding chapters. This framework is linked to the PETSc (\emph{Portable Extensible Toolkit for Scientific Computation}) library, which is a sophisticated toolkit for the parallelisation of solver applications. PETSc also provides a set of efficient preconditioners and Krylov subspace solvers for the solution of linear systems. Sections \ref{sec:gridpreproc} and \ref{sec:caffaimpl} then introduce the other building blocks of the framework, beginning with a grid generator for arbitrarily refined block-structured grids and a preprocessor program and concluding with implementation details of the CAFFA solvers. These details comprise the used message passing model, the control of convergence, and the data decomposition in the context of parallel computations.

Chapter \ref{sec:verification} presents the results of a conducted convergence study to verify the CAFFA framework. After briefly introducing the theory of the verification of scientific codes through manufactured solutions, the author proposes a manufactured solution for the particular formulation Navier-Stokes equations which uses the Boussinesq approximation. Then, the results of a grid convergence study are presented to prove the order of accuracy of the developed solvers within the CAFFA framework. The chapter concludes with the outcome of a short study on the effect which the under-relaxation factors of the velocities have on the final result of calculations.

Chapter \ref{sec:compare} presents the results of the performance tests conducted on the high-performance cluster \emph{HHLR} (\emph{Hessischer Hochleistungsrechner}) of TU Darmstadt. Having introduced the used hardware and software configuration and the relevant performance metrics, section \ref{sec:parallelperformance} presents program runtime measurements and the calculated application speedup. Furthermore, this section shows the results of a study conducted on the weak scalability of the implemented fully coupled solution algorithm. Section \ref{sec:channel} and section \ref{sec:cavity} present performance analyses regarding the efficiency of coupled and segregated solution algorithms for flow problems considering complex geometries and buoyant forces. Section \ref{sec:studynonorth} deals with the effect of different types of non-orthogonal correctors on the convergence of the coupled solution algorithm. This chapter concludes with section \ref{sec:load} proposing a simple load balancing technique based on automatic matrix partitioning.

The last chapter \ref{sec:conclusion} summarizes the results of the conducted research work, giving an outlook on further studies.

